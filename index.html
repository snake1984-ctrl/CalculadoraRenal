<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Calculadora Cl√≠nica de Par√°metros Renales</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="manifest" href="manifest.json" />
    <meta name="theme-color" content="#21808d" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="CalcRenal" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
</head>
<body>
  <div class="container">
        <!-- Header -->
        <header class="app-header">
            <h1 class="app-title">Calculadora cl√≠nica de par√°metros renales</h1>
            <p class="app-subtitle">Sistema completo de an√°lisis y c√°lculos renales</p>
        </header>

<!-- prueba -->

        <!-- Tab Navigation -->
        <div class="tabs-container">
            <nav class="tabs nav-tabs">
                <button id="datos-basicos-tab" class="tab-button nav-link active" data-tab="datos-basicos">üìä Datos B√°sicos</button>
                <button id="bioquimica-tab" class="tab-button nav-link" data-tab="bioquimica">üß™ Bioqu√≠mica</button>
                <button id="gasometria-tab" class="tab-button nav-link" data-tab="gasometria">ü´Å Gasometr√≠a</button>
                <button id="orina-puntual-tab" class="tab-button nav-link" data-tab="orina-puntual">üíß Orina Puntual</button>
                <button id="orina-24h-tab" class="tab-button nav-link" data-tab="orina-24h">‚è∞ Orina 24h</button>
                <button id="hematologia-tab" class="tab-button nav-link" data-tab="hematologia">ü©∏ Hematolog√≠a</button>
            </nav>

            <!-- Tab Contents -->
            <form id="clinicalForm">
                <!-- SECCI√ìN 1: DATOS B√ÅSICOS (3 campos) -->
                <div id="datos-basicos" class="tab-content active">
                    <h3 class="section-title"><i class="fas fa-user"></i> Datos B√°sicos del Paciente</h3>
                    <div class="form-grid-3col">
                        <div class="form-group">
                            <label class="form-label" for="fecha_nacimiento">Fecha de nacimiento</label>
                            <input type="text" id="fecha_nacimiento" class="form-control" placeholder="DD/MM/AAAA" maxlength="10">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="fecha_analitica">Fecha de anal√≠tica</label>
                            <div style="display: flex; gap: 8px;">
                                <input type="text" id="fecha_analitica" class="form-control" placeholder="DD/MM/AAAA" maxlength="10" style="flex: 1;">
                                <button type="button" class="btn btn-hoy" onclick="rellenarFechaHoy()" style="white-space: nowrap;">HOY</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="edad_calculada">Edad (calculada)</label>
                            <input type="text" id="edad_calculada" class="form-control" readonly placeholder="Se calcula autom√°ticamente" style="background-color: var(--color-bg-2);">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="peso_kg">Peso (kg)</label>
                            <input type="number" id="peso_kg" class="form-control" step="any" min="0" max="300">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="talla_cm">Talla (cm)</label>
                            <input type="number" id="talla_cm" class="form-control" step="any" min="0" max="250">
                        </div>
                    </div>
                </div>

                <!-- SECCI√ìN 2: BIOQU√çMICA PLASM√ÅTICA (13 campos orden corregido) -->
                <div id="bioquimica" class="tab-content">
                    <h3 class="section-title"><i class="fas fa-flask"></i> Bioqu√≠mica Plasm√°tica</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label" for="urea_mg_dl">Urea (mg/dL)</label>
                            <input type="number" id="urea_mg_dl" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="creatinina_enz_mg_dl">Creatinina enz (mg/dL)</label>
                            <input type="number" id="creatinina_enz_mg_dl" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="au_plasma_mg_dl">AU plasma (mg/dL)</label>
                            <input type="number" id="au_plasma_mg_dl" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="na_plasma_meq_l">Na plasma (mEq/L)</label>
                            <input type="number" id="na_plasma_meq_l" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="k_plasma_meq_l">K plasma (mEq/L)</label>
                            <input type="number" id="k_plasma_meq_l" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="cl_plasma_meq_l">Cl plasma (mEq/L)</label>
                            <input type="number" id="cl_plasma_meq_l" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="fosfatasa_alcalina_u_l">Fosfatasa alcalina (U/L)</label>
                            <input type="number" id="fosfatasa_alcalina_u_l" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="ca_plasma_mg_dl">Ca plasma (mg/dL)</label>
                            <input type="number" id="ca_plasma_mg_dl" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="p_plasma_mg_dl">P plasma (mg/dL)</label>
                            <input type="number" id="p_plasma_mg_dl" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="mg_plasma_mg_dl">Mg plasma (mg/dL)</label>
                            <input type="number" id="mg_plasma_mg_dl" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="pth_pg_ml">PTH (pg/mL)</label>
                            <input type="number" id="pth_pg_ml" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="vitamina_d_ng_ml">Vitamina D (ng/mL)</label>
                            <input type="number" id="vitamina_d_ng_ml" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="comentario_nutricional">Nutricional</label>
                            <textarea id="comentario_nutricional" class="form-control" rows="3" placeholder="Comentarios nutricionales (texto libre)"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="cistatina_c_mg_l">Cistatina C (mg/L)</label>
                            <input type="number" id="cistatina_c_mg_l" class="form-control" step="any" min="0">
                        </div>
                    </div>
                </div>

                <!-- SECCI√ìN 3: GASOMETR√çA (4 campos) -->
                <div id="gasometria" class="tab-content">
                    <h3 class="section-title">ü´Å Gasometr√≠a</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label" for="ph_plasma">pH plasma</label>
                            <input type="number" id="ph_plasma" class="form-control" step="any" min="6" max="8">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="pco2_mmhg">pCO2 (mmHg)</label>
                            <input type="number" id="pco2_mmhg" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="hco3_mmol_l">HCO3 (mmol/L)</label>
                            <input type="number" id="hco3_mmol_l" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="exceso_bases_mmol_l">Exceso bases (mmol/L)</label>
                            <input type="number" id="exceso_bases_mmol_l" class="form-control" step="any" min="-30" max="30">
                        </div>
                    </div>
                </div>

                <!-- SECCI√ìN 4: ORINA PUNTUAL (15 campos orden corregido) -->
                <div id="orina-puntual" class="tab-content">
                    <h3 class="section-title"><i class="fas fa-tint"></i> An√°lisis de Orina Puntual</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label" for="densidad">Densidad</label>
                            <input type="number" id="densidad" class="form-control" step="any" min="1000" max="1040">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="ph_orina">pH orina</label>
                            <input type="number" id="ph_orina" class="form-control" step="any" min="4" max="9">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="sedimento_urinario">Sedimento urinario</label>
                            <textarea id="sedimento_urinario" class="form-control" rows="3" placeholder="Descripci√≥n del sedimento urinario (texto libre)"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="au_orina_mg_dl">AU orina (mg/dL)</label>
                            <input type="number" id="au_orina_mg_dl" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="na_orina_meq_l">Na orina (mEq/L)</label>
                            <input type="number" id="na_orina_meq_l" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="k_orina_meq_l">K orina (mEq/L)</label>
                            <input type="number" id="k_orina_meq_l" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="cl_orina_meq_l">Cl orina (mEq/L)</label>
                            <input type="number" id="cl_orina_meq_l" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="osmolalidad_orina_mosm_kg">Osmolalidad orina (mOsm/Kg)</label>
                            <input type="number" id="osmolalidad_orina_mosm_kg" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="ca_orina_mg_dl">Ca orina (mg/dL)</label>
                            <input type="number" id="ca_orina_mg_dl" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="fosforo_orina_mg_dl">F√≥sforo orina (mg/dL)</label>
                            <input type="number" id="fosforo_orina_mg_dl" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="magnesio_orina_mg_dl">Magnesio orina (mg/dL)</label>
                            <input type="number" id="magnesio_orina_mg_dl" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="albumina_orina_mg_dl">Alb√∫mina orina (mg/dL)</label>
                            <input type="number" id="albumina_orina_mg_dl" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="creatinina_orina_mg_dl">Creatinina orina (mg/dL)</label>
                            <input type="number" id="creatinina_orina_mg_dl" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="proteinas_orina_mg_dl">Prote√≠nas orina (mg/dL)</label>
                            <input type="number" id="proteinas_orina_mg_dl" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="citrato_orina_mg_dl">Citrato orina (mg/dL)</label>
                            <input type="number" id="citrato_orina_mg_dl" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="oxalato_orina_mg_dl">Oxalato orina (mg/dL)</label>
                            <input type="number" id="oxalato_orina_mg_dl" class="form-control" step="any" min="0">
                        </div>
                    </div>
                </div>

                <!-- SECCI√ìN 5: ORINA 24H (8 campos orden corregido) -->
                <div id="orina-24h" class="tab-content">
                    <h3 class="section-title"><i class="fas fa-clock"></i> An√°lisis de Orina 24 Horas</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label" for="au_24h_mg">AU 24H (mg/24h)</label>
                            <input type="number" id="au_24h_mg" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="ca_24h_mg">Ca 24H (mg/24h)</label>
                            <input type="number" id="ca_24h_mg" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="p_24h_mg">P 24H (mg/24h)</label>
                            <input type="number" id="p_24h_mg" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="mg_24h_mg">Mg 24H (mg/24h)</label>
                            <input type="number" id="mg_24h_mg" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="albumina_24h_mg">Alb√∫mina 24H (mg/24h)</label>
                            <input type="number" id="albumina_24h_mg" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="proteinas_24h_mg">Prote√≠nas 24H (mg/24h)</label>
                            <input type="number" id="proteinas_24h_mg" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="citrato_24h_mg">Citrato 24H (mg/24h)</label>
                            <input type="number" id="citrato_24h_mg" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="oxalato_24h_mg">Oxalato 24H (mg/24h)</label>
                            <input type="number" id="oxalato_24h_mg" class="form-control" step="any" min="0">
                        </div>
                    </div>
                </div>

                <!-- SECCI√ìN 6: HEMATOLOG√çA (3 campos) -->
                <div id="hematologia" class="tab-content">
                    <h3 class="section-title"><i class="fas fa-heartbeat"></i> Hematolog√≠a</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label" for="hb_g_l">Hb (g/L)</label>
                            <input type="number" id="hb_g_l" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="ferritina_ng_ml">Ferritina (ng/mL)</label>
                            <input type="number" id="ferritina_ng_ml" class="form-control" step="any" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="ist_percent">IST (%)</label>
                            <input type="number" id="ist_percent" class="form-control" step="any" min="0" max="100">
                        </div>
                    </div>
                </div>
            </form>
        </div>

        <!-- CAMBIO 2: Zona de botones con jerarqu√≠a correcta -->
        <div class="zona-botones-principales">
            <!-- BOT√ìN PRINCIPAL (grande y centrado) -->
            <button type="button" class="btn btn-primary btn-lg btn-calcular" id="calculateButton">
                <i class="fas fa-calculator"></i> Calcular Resultados
            </button>
            
            <!-- BOTONES SECUNDARIOS (peque√±os, abajo) -->
            <div class="botones-secundarios">
                <button type="button" class="btn btn-outline-secondary btn-sm btn-limpiar" onclick="confirmarLimpiarFormulario()">
                    <i class="fas fa-trash-alt"></i> Limpiar
                </button>
               <button id="btn-cargar-datos-test" style="display:none;" onclick="loadSampleData()">Datos de ejemplo</button>

            </div>
        </div>

        <!-- Results Section -->
        <div id="results" class="results-section hidden">
            <h3><i class="fas fa-chart-line"></i> Resultados Calculados</h3>
            <div class="results-grid" id="resultsGrid">
                <!-- Los resultados se generar√°n din√°micamente aqu√≠ -->
            </div>
        </div>

        <!-- Report Section -->
        <div id="reportSection" class="report-section hidden">
            <h3><i class="fas fa-file-medical"></i> Informe Anal√≠tico</h3>
            <div class="report-content" id="reportContent">
                <!-- El informe se generar√° aqu√≠ -->
            </div>
            <div class="export-options">
                <button type="button" class="btn btn--primary" id="exportWordButton">üìÑ Descargar Word (.docx)</button>
                <button type="button" class="btn btn--primary" id="exportPDFButton">üìë Descargar PDF</button>
                <button type="button" class="btn btn--secondary" id="printButton">üñ®Ô∏è Imprimir</button>
            </div>
        </div>

        <!-- Field Counter - MEJORA 3: contador din√°mico -->
        <div class="field-count" id="fieldCount">0/46</div>
    </div>

  <script src="scripts.js"></script>
<script>
if ('serviceWorker' in navigator) {
  // Registro del service worker, ya lo tienes:
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('service-worker.js');
  });

  // Aviso de nueva versi√≥n, lo A√ëADES AQU√ç:
  navigator.serviceWorker.addEventListener('controllerchange', function() {
    alert('¬°Hay una nueva versi√≥n! Por favor, recarga la p√°gina para ver los cambios.');
  });
}
</script>


</body>
</html>









